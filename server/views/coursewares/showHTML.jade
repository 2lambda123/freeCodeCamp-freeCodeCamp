extends ../layout-wide
block content
    script(src='/js/components/codemirror/lib/codemirror.js')
    script(src='/js/components/codemirror/addon/edit/closebrackets.js')
    script(src='/js/components/codemirror/addon/edit/matchbrackets.js')
    script(src='/js/components/codemirror/addon/lint/lint.js')
    script(src='/js/components/codemirror/addon/lint/javascript-lint.js')
    script(src='//ajax.aspnetcdn.com/ajax/jshint/r07/jshint.js')
    script(src='/js/components/chai/chai.js')
    script(src='/js/components/chai/chai-jquery.js')
    link(rel='stylesheet', href='/js/components/codemirror/lib/codemirror.css')
    link(rel='stylesheet', href='/js/components/codemirror/addon/lint/lint.css')
    link(rel='stylesheet', href='/js/components/codemirror/theme/monokai.css')
    link(rel="stylesheet", href="http://fonts.googleapis.com/css?family=Ubuntu+Mono")
    script(src='/js/components/codemirror/mode/javascript/javascript.js')
    script(src='/js/components/jailed/lib/jailed.js')
    script(src='/js/lib/bonfire/bonfireInit.js')
    script(src='/js/components/codemirror/mode/xml/xml.js')
    script(src='/js/components/codemirror/mode/css/css.js')
    script(src='/js/components/codemirror/mode/htmlmixed/htmlmixed.js')
    script(src="https://cdn.jsdelivr.net/ramda/0.10.0/ramda.min.js")

    .row.courseware-height
        .col-xs-12.col-sm-12.col-md-3.col-lg-3
            .well
                .row
                    .col-xs-12
                        h2.text-center= name
                        .bonfire-instructions
                            p!= brief
                            #brief-instructions
                                #more-info.btn.btn-primary.btn-block.btn-primary-ghost
                                    span.ion-arrow-down-b
                                    | More information
                            #long-instructions.row.hide
                                .col-xs-12
                                    for sentence in details
                                        p!= sentence
                                    #less-info.btn.btn-primary.btn-block.btn-primary-ghost
                                        span.ion-arrow-up-b
                                        | Less information
                br


            - if (user)
                a.btn.btn-primary.btn-big.btn-block#complete-courseware
                    |  Go to my next challenge
                    br
                    |  (ctrl + enter)
                script.
                    var userLoggedIn = true;

            - else
                a.btn.btn-big.signup-btn.btn-block(href='/login') Sign in so you can save your progress
                script.
                    var userLoggedIn = false;
            br
            .btn.btn-info.btn-big.btn-block#showAllCoursewares Show me all the challenges
            br
            ul#testSuite.list-group

            br
            script(type="text/javascript").
                $('#complete-courseware').attr('disabled', 'disabled');
                var tests = !{JSON.stringify(tests)};
                var challengeSeed = !{JSON.stringify(challengeSeed)};
                var passedCoursewareHash = !{JSON.stringify(coursewareHash)};
                var challengeName = !{JSON.stringify(name)};
                var prodOrDev = !{JSON.stringify(environment)};
                var started = Math.floor(Date.now() / 1000);
                var url = '';
                var dashed = !{JSON.stringify(dashedName)};
                console.log(dashed);

        .col-xs-12.col-sm-12.col-md-5.col-lg-6
            #mainEditorPanel
                form.code
                    .form-group.codeMirrorView
                        textarea#codeEditor(autofocus=true)
                        script(src='/js/lib/coursewares/coursewaresHCJQFramework_v0.1.1.js')
        .col-md-4.col-lg-3
            .hidden-xs.hidden-sm
                img.iphone-position(src="https://s3.amazonaws.com/freecodecamp/iphone6-frame.png")
            iframe.iphone#preview


    #complete-courseware-dialog.modal(tabindex='-1')
        .modal-dialog.animated.zoomIn.fast-animation
            .modal-content
                .modal-header.challenge-list-header= compliment
                    a.close.closing-x(href='#', data-dismiss='modal', aria-hidden='true') ×
                .modal-body
                    .text-center
                        .animated.zoomInDown.delay-half
                            span.completion-icon.ion-checkmark-circled.text-primary
                    - if (user)
                        a.animated.fadeIn.btn.btn-lg.btn-primary.btn-block#next-courseware-button(name='_csrf', value=_csrf, ng-disabled='completedWithForm.$invalid && existingUser.length > 0') Go to my next challenge (ctrl + enter)
                        - if (user.progressTimestamps.length > 2)
                            a.animated.fadeIn.btn.btn-lg.btn-block.btn-twitter(target="_blank")
                                i.fa.fa-twitter &nbsp;
                                    = phrase

                    - else
                        a.animated.fadeIn.btn.btn-lg.signup-btn.btn-block(href='/login') Sign in so you can save your progress

    #all-coursewares-dialog.modal(tabindex='-1')
        .modal-dialog.animated.fadeInUp.fast-animation
            .modal-content
                .modal-header.all-list-header Challenges
                    a.close.closing-x(href='#', data-dismiss='modal', aria-hidden='true') ×
                .modal-body
                    include ../partials/coursewares
    script.
        $.ajax({
            url: 'https://api-ssl.bitly.com/v3/shorten?access_token=75e7931a19befaafcf108021b6d597e554b2c5c3&longUrl=http%3A%2F%2Ffreecodecamp.com%2Fchallenges%2F' + dashed + '&format=txt'
        })
                .success(
                function(data) {
                    console.log(data);
                    url = "https://twitter.com/intent/tweet?text=I%20just%20#{verb}%20%40FreeCodeCamp%20Challenge:%20#{name}&url=" + data + "&hashtags=LearnToCode, JavaScript";
                    $('.btn-twitter').attr('href', url);
                }
        );
